/* --- START OF FILE style.css --- */

:root {
    --primary-color: #c62828;
    --accent-color: #d32f2f;
    --bg-color: #f5f7fa;
    --card-bg: #ffffff;
    --text-main: #333333;
    --text-sub: #666666;
    --border-color: #eeeeee;
    
    /* 字体控制变量 */
    --font-family-main: 'Noto Serif SC', 'Noto Serif TC', 'Noto Serif JP', serif;
    --font-scale: 1.0; /* 默认比例 */
    
    --header-height: 60px;
    --shadow-sm: 0 2px 6px rgba(0, 0, 0, 0.04);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
    --radius-md: 12px; 
    --radius-lg: 12px;

    /* Dark Mode Variables */
    --bg-color-dark: #121212;
    --card-bg-dark: #1e1e1e;
    --text-main-dark: #ffffff;
    --text-sub-dark: #cccccc;
    --border-color-dark: #333333;
    --header-bg-dark: #1e1e1e;
}

* {
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: var(--font-family-main);
    background-color: var(--bg-color);
    margin: 0;
    padding: 0;
    color: var(--text-main);
    padding-top: var(--header-height);
    -webkit-font-smoothing: antialiased;
    /* 全局字体大小基准，随设置调整 */
    font-size: calc(14px * var(--font-scale));
}

/* --- Header --- */
.header {
    position: fixed; top: 0; left: 0; right: 0;
    height: var(--header-height);
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
    z-index: 1000; box-shadow: var(--shadow-sm);
    display: flex; align-items: center; justify-content: center;
    transition: transform 0.3s ease-in-out;
    border-bottom: 1px solid rgba(0,0,0,0.02);
}
.header.header-hidden { transform: translateY(-100%); }

.header-content {
    width: 100%; max-width: 600px; padding: 0 16px; height: 100%;
    display: flex; justify-content: space-between; align-items: center;
}

.header-title h1 {
    margin: 0; font-weight: 900; line-height: 1.1; font-size: 18px;
    color: var(--text-main);
}
.header-title p {
    margin: 0; font-size: 10px; color: var(--text-sub); letter-spacing: 0.5px;
}

/* Header Buttons */
.nav-bar { display: flex; gap: 8px; }
.nav-btn {
    width: 32px; height: 32px;
    display: flex; justify-content: center; align-items: center;
    border-radius: 8px; background: transparent; cursor: pointer;
    position: relative; /* 用于定位角标 */
}
.nav-btn:active { background: rgba(0,0,0,0.05); }
.nav-icon { width: 20px; height: 20px; fill: var(--text-main); }

/* Badge Correction */
#fav-badge {
    position: absolute; 
    top: 0; 
    right: 0; 
    background-color: #e74c3c; 
    color: white;
    font-size: 8px; 
    min-width: 14px; 
    height: 14px; 
    line-height: 14px; 
    text-align: center; 
    border-radius: 50%; 
    display: none; 
    border: 1px solid white;
    transform: translate(30%, -30%); /* 微调位置到右上角 */
}

/* Category Nav */
.category-nav-container {
    position: sticky; top: var(--header-height);
    background: var(--bg-color); z-index: 900; padding: 8px 0; min-height: 48px;
}
.header.header-hidden ~ .container .category-nav-container { top: 0; transition: top 0.3s ease-in-out; }
.category-scroll {
    display: flex; overflow-x: auto; gap: 8px; padding: 0 16px;
    scrollbar-width: none; align-items: center; height: 100%;
}
.category-scroll::-webkit-scrollbar { display: none; }

.cat-pill {
    flex-shrink: 0; padding: 4px 10px; border-radius: 6px;
    font-size: 11px; font-weight: 600; cursor: pointer;
    transition: all 0.2s; border: 1px solid transparent;
    opacity: 0.75; filter: grayscale(20%);
}
.cat-pill.active {
    opacity: 1; filter: grayscale(0%);
    box-shadow: 0 2px 5px rgba(0,0,0,0.1); transform: scale(1.05);
}

/* Container */
.container {
    position: relative; max-width: 600px; margin: 0 auto;
    padding-bottom: 40px; min-height: 100vh;
}
.control-bar {
    width: 100%; padding: 0 16px 12px 16px;
    display: flex; justify-content: space-between; align-items: flex-end;
}
.control-info { display: flex; flex-direction: column; justify-content: flex-end; max-width: 60%; }
#list-title {
    font-size: 13px !important; font-weight: bold !important;
    color: var(--text-main); margin-bottom: 2px; line-height: 1.2;
}
#last-update-time {
    font-size: 10px !important; color: var(--text-sub) !important; font-weight: 400;
}

/* Search */
.search-wrapper { position: relative; width: 110px; }
.search-input {
    width: 100%; padding: 5px 10px 5px 26px;
    border-radius: var(--radius-md); border: 1px solid rgba(0,0,0,0.1);
    background: #ffffff; font-size: 11px; font-family: inherit;
    outline: none; color: var(--text-main); transition: width 0.2s;
}
.search-input:focus {
    border-color: var(--primary-color); width: 140px; position: absolute; right: 0; z-index: 10;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}
.search-icon-small {
    position: absolute; left: 8px; top: 50%; transform: translateY(-50%);
    width: 12px; height: 12px; fill: #999; pointer-events: none; z-index: 11;
}

/* News List & Cards */
#news-list { display: flex; flex-direction: column; gap: 12px; padding: 0 10px; }

.card {
    background: var(--card-bg); border-radius: var(--radius-lg);
    overflow: hidden; box-shadow: var(--shadow-sm);
    position: relative; cursor: default;
    border: 1px solid rgba(0, 0, 0, 0.03);
}

.card-body {
    padding: 12px; display: flex; justify-content: space-between; align-items: stretch; gap: 10px;
}

.card-content-left {
    flex: 1; min-width: 0; display: flex; flex-direction: column; justify-content: flex-start;
}
.card-content-right {
    display: flex; flex-direction: column; justify-content: space-between;
    align-items: flex-end; min-width: 70px; flex-shrink: 0;
}

.card-image-right {
    width: 64px; height: 64px; border-radius: 8px; overflow: hidden;
    background: #f9f9f9; display: none; border: 1px solid rgba(0,0,0,0.03); margin-top: 4px;
}
.card-image-right.has-image { display: block; }
.card-image-right img { width: 100%; height: 100%; object-fit: cover; }
.card-image-right img.is-logo { object-fit: contain; padding: 10px; }

.card-origin-text {
    font-size: 10px; color: var(--text-sub); text-align: right;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100px;
}

.card-meta-left { display: flex; align-items: center; gap: 6px; margin-bottom: 6px; flex-wrap: wrap; }

.card-fav-icon {
    width: 24px; height: 24px;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; margin-right: 2px;
}
.card-fav-icon svg { width: 16px; height: 16px; fill: #ddd; transition: all 0.2s; }
.card-fav-icon.active svg { fill: var(--accent-color); transform: scale(1.1); }

.tag {
    font-size: 10px; padding: 2px 8px; border-radius: 4px; 
    font-weight: 600; white-space: nowrap; cursor: pointer;
}
.tag-time { background: #f5f5f5; color: #999; font-weight: 400; cursor: default; }

/* Colors */
.tag-cat-politics { background: #E3F2FD; color: #1565C0; }
.tag-cat-economy { background: #E0F2F1; color: #00695C; }
.tag-cat-society { background: #FFF3E0; color: #E65100; }
.tag-cat-military { background: #FFEBEE; color: #C62828; }
.tag-cat-tech { background: #F3E5F5; color: #6A1B9A; }
.tag-cat-sports { background: #E1F5FE; color: #0277BD; }
.tag-cat-other { background: #FFEBEE; color: #B71C1C; }
.tag-cat-all { background: #333; color: #fff; }

.card-title {
    /* 响应式字体 */
    font-size: calc(15px * var(--font-scale));
    font-weight: 700; line-height: 1.45;
    margin-bottom: 8px; color: var(--text-main);
    display: -webkit-box; -webkit-line-clamp: 3;
    -webkit-box-orient: vertical; overflow: hidden;
    user-select: text;
}
.card-title-ja {
    font-size: calc(11px * var(--font-scale));
    margin-top: 2px; line-height: 1.3;
    display: -webkit-box; -webkit-line-clamp: 1;
    -webkit-box-orient: vertical; overflow: hidden;
}
.card-title-ja a {
    color: var(--text-sub); text-decoration: underline; text-decoration-color: rgba(0,0,0,0.2);
    cursor: pointer; padding: 4px 0;
}

/* --- Inline Archive (Grid 8) --- */
.inline-archive-container {
    padding: 10px 0; margin: 10px 0;
}
/* 强制单行8列 */
.calendar-week {
    display: grid;
    grid-template-columns: repeat(8, 1fr); /* 8列 */
    gap: 4px; /* 间距缩小 */
}
.calendar-day {
    background: white; border-radius: 8px; padding: 0;
    height: 54px; /* 固定高度 */
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05); cursor: pointer; border: 1px solid transparent;
}
.calendar-day.disabled { opacity: 0.5; pointer-events: none; background: #f9f9f9; }
.day-name { font-size: 8px; color: #aaa; margin-bottom: 1px; line-height: 1; }
.day-number { font-size: 11px; font-weight: 700; color: var(--text-main); line-height: 1.2; }
.day-count { font-size: 8px; color: #999; line-height: 1; margin-top: 1px; }

.calendar-day-today { border: 1px solid var(--primary-color); background: #fff5f5; }
.archive-btn-block { background: var(--text-main); color: white; }
.archive-btn-block .day-name { color: rgba(255,255,255,0.7); }
.archive-btn-block .day-number { color: white; font-size: 14px; }

/* Settings */
.settings-group {
    margin-bottom: 16px; border-bottom: 1px solid rgba(0,0,0,0.05); padding-bottom: 16px;
}
.settings-group:last-child { border-bottom: none; }
.settings-group-title { font-size: 12px; color: #999; margin-bottom: 8px; padding-left: 4px; }
.settings-row {
    display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;
}
/* 设置菜单字体大小跟随变量 */
.settings-row span { font-size: calc(13px * var(--font-scale)); }
.settings-btn-group { display: flex; gap: 8px; }
.settings-option-btn {
    padding: 6px 12px; border-radius: 6px; border: 1px solid #ddd;
    background: #f5f5f5; color: #333; font-size: calc(12px * var(--font-scale)); cursor: pointer;
    min-width: 60px; text-align: center;
}
.settings-option-btn.active {
    background: var(--primary-color); color: white; border-color: var(--primary-color);
}
.disclaimer-text {
    font-size: calc(11px * var(--font-scale));
    color: #999; line-height: 1.5; padding: 10px; background: #f9f9f9; border-radius: 8px;
}

/* Modals */
.modal-overlay {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0, 0, 0, 0.6); z-index: 2000;
    display: none; align-items: center; justify-content: center;
    backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px);
}
.modal-overlay.show { display: flex; }
.modal-content {
    background: white; width: 85%; max-width: 360px; max-height: 80vh;
    border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    display: flex; flex-direction: column; overflow: hidden;
}
.modal-header {
    padding: 12px 16px; border-bottom: 1px solid #eee;
    display: flex; justify-content: space-between; align-items: center;
}
.modal-title { font-weight: 700; font-size: 16px; }
.modal-body { padding: 16px; overflow-y: auto; }

/* List Item */
.list-item { padding: 12px 16px; border-bottom: 1px solid rgba(0,0,0,0.05); background: var(--card-bg); }
.list-item a { color: var(--text-main); text-decoration: none; font-size: 13px; display: block; margin-bottom: 4px; font-weight: 500; }
.list-item-meta { display: flex; justify-content: space-between; font-size: 10px; color: var(--text-sub); }
.btn-delete { color: #e74c3c; cursor: pointer; background: rgba(231, 76, 60, 0.08); padding: 2px 6px; border-radius: 4px; }

/* Dark Mode */
body.dark-mode { background-color: var(--bg-color-dark); color: var(--text-main-dark); }
body.dark-mode .header { background: rgba(30, 30, 30, 0.98); border-bottom-color: #333; }
body.dark-mode .header-title h1 { color: #ffffff !important; }
body.dark-mode .nav-icon { fill: #ffffff; }
body.dark-mode .card { background: var(--card-bg-dark); border-color: #333; }
body.dark-mode .card-title { color: #ffffff; }
body.dark-mode .category-nav-container { background: var(--bg-color-dark); }
body.dark-mode .search-input { background: #2c2c2c; color: #ffffff; border-color: #444; }
body.dark-mode .tag-time { background: #333; color: #888; }
body.dark-mode .card-image-right { background: #2a2a2a; border-color: #333; }
body.dark-mode .modal-content, body.dark-mode .modal-header { background: #252525; color: #ffffff; border-color: #333; }
body.dark-mode .list-item { background: #252525; border-bottom-color: #333; }
body.dark-mode .list-item a { color: #ffffff; }
body.dark-mode .settings-option-btn { background: #333; color: #fff; border-color: #444; }
body.dark-mode .disclaimer-text { background: #333; color: #aaa; }
body.dark-mode .calendar-day { background: #252525; }
body.dark-mode .day-number { color: #fff; }
body.dark-mode .archive-btn-block { background: #444; color: #fff; }
body.dark-mode .card-title-ja a { color: #bbb; text-decoration-color: #555; }

/* Sports Tag Dark Mode Fix */
body.dark-mode .tag-cat-sports { background: #004d40; color: #e0f2f1; }
/* Other Tags Dark Mode */
body.dark-mode .tag-cat-politics { background: #1a2f42; color: #90caf9; }
body.dark-mode .tag-cat-economy { background: #1a332e; color: #80cbc4; }
body.dark-mode .tag-cat-society { background: #3e2723; color: #ffcc80; }
body.dark-mode .tag-cat-military { background: #311b1b; color: #ef9a9a; }
body.dark-mode .tag-cat-tech { background: #2d1a33; color: #ce93d8; }
body.dark-mode .tag-cat-other { background: #3b1818; color: #ffab91; }
body.dark-mode .tag-cat-all { background: #555; color: #fff; }